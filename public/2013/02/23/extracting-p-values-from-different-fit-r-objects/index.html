<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<meta property="og:title" content="Extracting p-values from different fit R objects" />
<meta property="og:description" content="Let&rsquo;s say you want to extract a p-value and save it as a variable for future use from a linear or generalized linear model - mixed or non! This is something you might want to do if, say, you were calculating Fisher&rsquo;s C from an equation-level Structural Equation Model. Here&rsquo;s how to extract the effect of a variable from multiple different fit models. We&rsquo;ll start with a data set with x, y, z, and a block effect (we&rsquo;ll see who in a moment)." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/2013/02/23/extracting-p-values-from-different-fit-r-objects/" />
<meta property="article:published_time" content="2013-02-23T00:00:00+00:00" />
<meta property="article:modified_time" content="2013-02-23T00:00:00+00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Extracting p-values from different fit R objects"/>
<meta name="twitter:description" content="Let&rsquo;s say you want to extract a p-value and save it as a variable for future use from a linear or generalized linear model - mixed or non! This is something you might want to do if, say, you were calculating Fisher&rsquo;s C from an equation-level Structural Equation Model. Here&rsquo;s how to extract the effect of a variable from multiple different fit models. We&rsquo;ll start with a data set with x, y, z, and a block effect (we&rsquo;ll see who in a moment)."/>


    <meta name="description" content="">
    <link rel="canonical" href="../../../../2013/02/23/extracting-p-values-from-different-fit-r-objects/">

    
    <title>Extracting p-values from different fit R objects &middot; I&#39;m a Chordata! Urochordata!</title>

    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
    <link href="../../../../css/style.css" rel="stylesheet">

    

    

    
  </head>
  <body>
    
      



<nav class="white" role="navigation">
    <div class="row max-width">
        <div class="col s12 l10 offset-l1">
            
            <a href="#" data-target="nav-mobile" class="sidenav-trigger black-text">
                <i class="material-icons">menu</i>
            </a>

            
            <ul id="nav-mobile" class="sidenav">
                
                
    
        
            
<li>
    <a class="black-text" href="../../../../about/">About</a>
</li>

        
    
        
            
<li>
    <a class="black-text" href="../../../../categories/">Categories</a>
</li>

        
    
        
            
<li>
    <a class="black-text" href="https://byrneslab.net">Lab Site</a>
</li>

        
    
        
            
<li>
    <a class="black-text" href="https://twitter.com/jebyrnes">Twitter</a>
</li>

        
    
    

            </ul>

            
            <a href="../../../../" class="brand-logo grey-text text-darken-3">I&#39;m a Chordata! Urochordata!</a>

            
            <div class="nav-wrapper">

                
                <ul class="right hide-on-med-and-down">
                    
                    
    
        
            
<li>
    <a class="black-text" href="../../../../about/">About</a>
</li>

        
    
        
            
<li>
    <a class="black-text" href="../../../../categories/">Categories</a>
</li>

        
    
        
            
<li>
    <a class="black-text" href="https://byrneslab.net">Lab Site</a>
</li>

        
    
        
            
<li>
    <a class="black-text" href="https://twitter.com/jebyrnes">Twitter</a>
</li>

        
    
    

                </ul>

            </div>
        </div>
    </div>
</nav>
    

    

<article class="max-width">
    
    <section class="row">
        <div class="col s12 m10 offset-m1 l10 offset-l1">
            <h1>Extracting p-values from different fit R objects</h1>
        </div>
    </section>

    
    

    
    <section class="row">
        <div class="col s12 m8 offset-m2 l2 offset-l1">
            

<p class="article-meta">
    <div class="article-meta-container">
        <div class="article-meta-author-name">Jarrett Byrnes</div>
        <div class="article-meta-description"></div>
    </div>
    <span class="article-meta-published-at grey-text text-darken-1">Feb 23, 2013</span>
</p>
        </div>
        <div class="col s12 m8 offset-m2 l6">
            <p>Let&rsquo;s say you want to extract a p-value and save it as a variable for future use from a linear or generalized linear model - mixed or non!  This is something you might want to do if, say, you were calculating Fisher&rsquo;s C from an equation-level Structural Equation Model.  Here&rsquo;s how to extract the effect of a variable from multiple different fit models.  We&rsquo;ll start with a data set with x, y, z, and a block effect (we&rsquo;ll see who in a moment).</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">x <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">rep</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">2</span>)
y <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">rnorm</span>(<span style="color:#ae81ff">20</span>, x, <span style="color:#ae81ff">3</span>)
block <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">c</span>(<span style="color:#a6e22e">rep</span>(<span style="color:#e6db74">&#34;a&#34;</span>, <span style="color:#ae81ff">10</span>), <span style="color:#a6e22e">rep</span>(<span style="color:#e6db74">&#34;b&#34;</span>, <span style="color:#ae81ff">10</span>))

mydata <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">data.frame</span>(x <span style="color:#f92672">=</span> x, y <span style="color:#f92672">=</span> y, block <span style="color:#f92672">=</span> block, z <span style="color:#f92672">=</span> <span style="color:#a6e22e">rnorm</span>(<span style="color:#ae81ff">20</span>))
</code></pre></div><p>Now, how would you extract the p-value for the parameter fit for z from a linear model object?  Simply put, use the t-table from the lm object&rsquo;s summary</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">alm <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">lm</span>(y <span style="color:#f92672">~</span> x <span style="color:#f92672">+</span> z, data <span style="color:#f92672">=</span> mydata)

<span style="color:#a6e22e">summary</span>(alm)<span style="color:#f92672">$</span>coefficients

<span style="color:#75715e">##             Estimate Std. Error t value Pr(&gt;|t|)</span>
<span style="color:#75715e">## (Intercept)   1.1833     1.3496  0.8768 0.392840</span>
<span style="color:#75715e">## x             0.7416     0.2190  3.3869 0.003506</span>
<span style="color:#75715e">## z            -0.4021     0.8376 -0.4801 0.637251</span>

<span style="color:#75715e"># Note that this is a matrix.</span>
<span style="color:#75715e"># The third row, fourth column is the p value</span>
<span style="color:#75715e"># you want, so...</span>

p.lm <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">summary</span>(alm)<span style="color:#f92672">$</span>coefficients[3, <span style="color:#ae81ff">4</span>]

p.lm

<span style="color:#75715e">## [1] 0.6373</span>
</code></pre></div><p>That&rsquo;s a linear model, what about a generalized linear model?</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">aglm <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">glm</span>(y <span style="color:#f92672">~</span> x <span style="color:#f92672">+</span> z, data <span style="color:#f92672">=</span> mydata)

<span style="color:#a6e22e">summary</span>(aglm)<span style="color:#f92672">$</span>coefficients

<span style="color:#75715e">##             Estimate Std. Error t value Pr(&gt;|t|)</span>
<span style="color:#75715e">## (Intercept)   1.1833     1.3496  0.8768 0.392840</span>
<span style="color:#75715e">## x             0.7416     0.2190  3.3869 0.003506</span>
<span style="color:#75715e">## z            -0.4021     0.8376 -0.4801 0.637251</span>

<span style="color:#75715e"># Again, is a matrix.</span>
<span style="color:#75715e"># The third row, fourth column is the p value you</span>
<span style="color:#75715e"># want, so...</span>

p.glm <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">summary</span>(aglm)<span style="color:#f92672">$</span>coefficients[3, <span style="color:#ae81ff">4</span>]

p.glm

<span style="color:#75715e">## [1] 0.6373</span>
</code></pre></div><p>That&rsquo;s a linear model, what about a generalized linear model?</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">anls <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">nls</span>(y <span style="color:#f92672">~</span> a <span style="color:#f92672">*</span> x <span style="color:#f92672">+</span> b <span style="color:#f92672">*</span> z, data <span style="color:#f92672">=</span> mydata,
     start <span style="color:#f92672">=</span> <span style="color:#a6e22e">list</span>(a <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>, b <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>))

<span style="color:#a6e22e">summary</span>(anls)<span style="color:#f92672">$</span>coefficients

<span style="color:#75715e">##   Estimate Std. Error t value  Pr(&gt;|t|)</span>
<span style="color:#75715e">## a   0.9118     0.1007   9.050 4.055e-08</span>
<span style="color:#75715e">## b  -0.4651     0.8291  -0.561 5.817e-01</span>

<span style="color:#75715e"># Again, is a matrix.</span>
<span style="color:#75715e"># The second row, fourth column is the p value you</span>
<span style="color:#75715e"># want, so...</span>

p.nls <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">summary</span>(anls)<span style="color:#f92672">$</span>coefficients[2, <span style="color:#ae81ff">4</span>]

p.nls

<span style="color:#75715e">## [1] 0.5817</span>
</code></pre></div><p>Great.  Now, what if we were running a mixed model?  First, let&rsquo;s look at the nlme package. Here, the relevant part of the summary object is the tTable</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">library</span>(nlme)
alme <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">lme</span>(y <span style="color:#f92672">~</span> x <span style="color:#f92672">+</span> z, random <span style="color:#f92672">=</span> <span style="color:#f92672">~</span><span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span> block, data <span style="color:#f92672">=</span> mydata)

<span style="color:#a6e22e">summary</span>(alme)<span style="color:#f92672">$</span>tTable

<span style="color:#75715e">##               Value Std.Error DF t-value  p-value</span>
<span style="color:#75715e">## (Intercept)  1.1833    1.3496 16  0.8768 0.393592</span>
<span style="color:#75715e">## x            0.7416    0.2190 16  3.3869 0.003763</span>
<span style="color:#75715e">## z           -0.4021    0.8376 16 -0.4801 0.637630</span>

<span style="color:#75715e"># Again, is a matrix.</span>
<span style="color:#75715e"># But now the third row, fifth column is the p value</span>
<span style="color:#75715e"># you want, so...</span>

p.lme <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">summary</span>(alme)<span style="color:#f92672">$</span>tTable[3, <span style="color:#ae81ff">5</span>]

p.lme

<span style="color:#75715e">## [1] 0.6376</span>
</code></pre></div><p>Last, what about lme4?  Now, for a linear lmer object, you cannot get a p value.  But, if this is a generalizes linear mixed model, you are good to go (as in Shipley 2009).  Let&rsquo;s try that here.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">library</span>(lme4)

almer <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">lmer</span>(y <span style="color:#f92672">~</span> x <span style="color:#f92672">+</span> z <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span> block, data <span style="color:#f92672">=</span> mydata)

<span style="color:#75715e"># no p-value!</span>
<span style="color:#a6e22e">summary</span>(almer)<span style="color:#f92672">@</span>coefs

<span style="color:#75715e">##             Estimate Std. Error t value</span>
<span style="color:#75715e">## (Intercept)    4.792     0.5823   8.231</span>

<span style="color:#75715e"># but, for a genearlined linear mixed model</span>
<span style="color:#75715e"># and yes, I know this is a</span>
<span style="color:#75715e"># bad model but, you know, demonstration!</span>

aglmer <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">lmer</span>(y <span style="color:#f92672">+</span> <span style="color:#ae81ff">5</span> <span style="color:#f92672">~</span> x <span style="color:#f92672">+</span> z <span style="color:#f92672">+</span> (<span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span> block),
        data <span style="color:#f92672">=</span> mydata, family <span style="color:#f92672">=</span> <span style="color:#a6e22e">poisson</span>(link <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;log&#34;</span>))

<span style="color:#a6e22e">summary</span>(aglmer)<span style="color:#f92672">@</span>coefs

<span style="color:#75715e">##             Estimate Std. Error z value  Pr(&gt;|z|)</span>
<span style="color:#75715e">## (Intercept)  1.90813    0.16542  11.535 8.812e-31</span>
<span style="color:#75715e">## x            0.07247    0.02471   2.933 3.362e-03</span>
<span style="color:#75715e">## z           -0.03193    0.09046  -0.353 7.241e-01</span>

<span style="color:#75715e"># matrix again!  Third row, fourth column</span>
p.glmer <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">summary</span>(aglmer)<span style="color:#f92672">@</span>coefs[3, <span style="color:#ae81ff">4</span>]

p.glmer

<span style="color:#75715e">## [1] 0.7241</span>
</code></pre></div>
        </div>
    </section>
</article>



    
      <footer class="page-footer grey lighten-5">
    <div class="row max-width">
        <div class="col s12 l10 offset-l1 clear-padding">
            <div class="row">
    
        
    

    
    
    <div class="col s12 l12">
        <h5 class="black-text">Footer Content</h5>
<p class="grey-text text-darken-4">You can use rows and columns here to organize your footer content.</p>
    </div>

    
</div>


        </div>
    </div>
    <div class="footer-copyright">
        <div class="row max-width" style="width: 100%;">
            <div class="col s12 l10 offset-l1">
                <span class="grey-text text-darken-4"></span>
<div class="right">
    
</div>
            </div>
        </div>
    </div>
</footer>
    

    
    <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    <script src="../../../../js/script.js"></script>
  </body>
</html>