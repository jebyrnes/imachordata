<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    
    <meta property="og:site_name" content="Huabing Blog">
    <meta property="og:type" content="article">

    
    <meta property="og:image" content="//img/home-bg-jeep.jpg">
    <meta property="twitter:image" content="//img/home-bg-jeep.jpg" />
    

    
    <meta name="title" content="Do Not Log-Transform Count Data, Bitches!" />
    <meta property="og:title" content="Do Not Log-Transform Count Data, Bitches!" />
    <meta property="twitter:title" content="Do Not Log-Transform Count Data, Bitches!" />
    

    
    <meta name="description" content="赵化冰，程序员, 开源爱好者，生活探险家 | 这里是 赵化冰 的博客，与你一起发现更大的世界。">
    <meta property="og:description" content="赵化冰，程序员, 开源爱好者，生活探险家 | 这里是 赵化冰 的博客，与你一起发现更大的世界。" />
    <meta property="twitter:description" content="赵化冰，程序员, 开源爱好者，生活探险家 | 这里是 赵化冰 的博客，与你一起发现更大的世界。" />
    

    
    <meta property="twitter:card" content="summary" />
    
    

    <meta name="keyword"  content="赵化冰, zhaohuabing, Zhaohuabing, , 赵化冰的网络日志, 赵化冰的博客, Zhaohuabing Blog, 博客, 个人网站, 互联网, Web, 云原生, PaaS, Istio, Kubernetes, 微服务, Microservice">
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>Do Not Log-Transform Count Data, Bitches!-赵化冰的博客 | Zhaohuabing Blog</title>

    <link rel="canonical" href="/post/do-not-log-transform-count-data-bitches/">

    <link rel="stylesheet" href="/css/iDisqus.min.css"/>
	
    
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    
    <link rel="stylesheet" href="/css/hux-blog.min.css">

    
    <link rel="stylesheet" href="/css/syntax.css">

    
    <link rel="stylesheet" href="/css/zanshang.css">

    
    <link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    
    
    <script src="/js/jquery.min.js"></script>
    
    
    <script src="/js/bootstrap.min.js"></script>
    
    
    <script src="/js/hux-blog.min.js"></script>
	
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/styles/docco.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
</head>


<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Huabing Blog</a>
        </div>

        
        
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>
                    
                    <li>
                        <a href="/categories/#scifund">#scifund</a>
                    </li>
                    
                    <li>
                        <a href="/categories/announcements">announcements</a>
                    </li>
                    
                    <li>
                        <a href="/categories/ascidians">ascidians</a>
                    </li>
                    
                    <li>
                        <a href="/categories/blog">blog</a>
                    </li>
                    
                    <li>
                        <a href="/categories/climate-change">climate-change</a>
                    </li>
                    
                    <li>
                        <a href="/categories/feedback">feedback</a>
                    </li>
                    
                    <li>
                        <a href="/categories/field-notes">field-notes</a>
                    </li>
                    
                    <li>
                        <a href="/categories/food-web-networks-and-extinctions">food-web-networks-and-extinctions</a>
                    </li>
                    
                    <li>
                        <a href="/categories/howto">howto</a>
                    </li>
                    
                    <li>
                        <a href="/categories/linkage">linkage</a>
                    </li>
                    
                    <li>
                        <a href="/categories/meetings">meetings</a>
                    </li>
                    
                    <li>
                        <a href="/categories/neat">neat</a>
                    </li>
                    
                    <li>
                        <a href="/categories/networks">networks</a>
                    </li>
                    
                    <li>
                        <a href="/categories/openpub">openpub</a>
                    </li>
                    
                    <li>
                        <a href="/categories/paper-review">paper-review</a>
                    </li>
                    
                    <li>
                        <a href="/categories/professional-musings">professional-musings</a>
                    </li>
                    
                    <li>
                        <a href="/categories/publishing">publishing</a>
                    </li>
                    
                    <li>
                        <a href="/categories/r">r</a>
                    </li>
                    
                    <li>
                        <a href="/categories/rantish">rantish</a>
                    </li>
                    
                    <li>
                        <a href="/categories/research">research</a>
                    </li>
                    
                    <li>
                        <a href="/categories/science">science</a>
                    </li>
                    
                    <li>
                        <a href="/categories/science-music-videos">science-music-videos</a>
                    </li>
                    
                    <li>
                        <a href="/categories/science-online">science-online</a>
                    </li>
                    
                    <li>
                        <a href="/categories/science-parent">science-parent</a>
                    </li>
                    
                    <li>
                        <a href="/categories/sem">sem</a>
                    </li>
                    
                    <li>
                        <a href="/categories/shout-out">shout-out</a>
                    </li>
                    
                    <li>
                        <a href="/categories/silly">silly</a>
                    </li>
                    
                    <li>
                        <a href="/categories/statistics">statistics</a>
                    </li>
                    
                    <li>
                        <a href="/categories/talks">talks</a>
                    </li>
                    
                    <li>
                        <a href="/categories/tunicate-culinary-adventures">tunicate-culinary-adventures</a>
                    </li>
                    
                    
		    
                        <li><a href="/top/books/">BOOKS</a></li>
                    
                        <li><a href="/top/about/">ABOUT</a></li>
                    

                    
		    <li>
                        <a href="/search">SEARCH <img src="/img/search.png" height="15" style="cursor: pointer;" alt="Search"></a>
		    </li>
                    
                </ul>
            </div>
        </div>
        
    </div>
    
</nav>
<script>
    
    
    
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        
            $navbar.className = " ";
            
            setTimeout(function(){
                
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>




<style type="text/css">
    header.intro-header {
        background-image: url('/img/home-bg-jeep.jpg')
    }
</style>
<header class="intro-header">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="tags">
                        
                    </div>
                    <h1>Do Not Log-Transform Count Data, Bitches!</h1>
                    <h2 class="subheading"></h2>
                    <span class="meta">
			Posted by 
			
			    Jarrett Byrnes
			 
			on 
			Thursday, June 17, 2010
                        
                    </span>
                </div>
            </div>
        </div>
    </div>
</header>




<article>
    <div class="container">
        <div class="row">

            
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

                
                <header>
                    <h2>TOC</h2>
                </header>
                
                
                <p><a href="http://www.researchblogging.org"><img src="http://www.researchblogging.org/public/citation_icons/rb2_large_gray.png" alt="ResearchBlogging.org" /></a> OK, so, the title of this article is actually <em><a href="10.1111/j.2041-210X.2010.00021.x">Do not log-transform count data</a></em>, but, as <a href="http://twitter.com/ascidiacea/status/16330589793">@ascidacea</a> mentioned, you just can&rsquo;t resist adding the &ldquo;bitches&rdquo; to the end.</p>

<p>Onwards.</p>

<p>If you&rsquo;re like me, when you learned experimental stats, you were taught to worship at the throne of the Normal Distribution.  Always check your data and make sure it is normally distributed!  Or, make sure that whatever lines you fit to it have normally distributed error around them!  Normal!  Normal normal normal!</p>

<p>And if you violate normality - say, you have count data with no negative values, and a normal linear regression would create situations where negative values are possible (e.g., what does it mean if you predict negative kelp!  ah, the old dreaded nega-kelp), then no worries.  Just log transform your data.  Or square root.  Or log(x+1). Or SOMETHING to linearize it before fitting a line and ensure the sacrament of normality is preserved.</p>

<p>This has led to decades of thoughtless transformation of count data without any real thought as to the consequences by in-the-field ecologists.</p>

<p>But statistics has had a better answer for decades - <a href="http://en.wikipedia.org/wiki/Generalized_linear_model">generalized linear models</a> (<a href="http://sekhon.berkeley.edu/stats/html/glm.html">glm</a> for R nerds, gzlm for SAS goombas who use <a href="https://docs.google.com/viewer?url=http://www.okstate.edu/sas/v8/saspdf/stat/chap29.pdf&amp;pli=1">proc genmod</a>.  What? I&rsquo;m biased!) whereby one specifies a nonlinear function with a corresponding non-normal error distribution.  The <a href="http://amzn.to/czFuPq">canonical book</a> on this was first published &lsquo;round 1983.  Sure, one has to think more about the particular model and error distribution they specify, but, if you&rsquo;re not thinking about these things in the first place, why are you doing science?</p>

<p>&ldquo;But, hey!&rdquo; you might say,  &ldquo;Glms and transformed count data should produce the same results, no?&rdquo;</p>

<p>From first principles, Jensen&rsquo;s inequality says no - consider the consequences for error of the transformation  approach of log(y) = ax+b+error versus the glm approach y=e^(ax+b)+error.   More importantly, the error distributions from generalized linear models may often be far far faaar more appropriate to the data you have at hand.  For example, count data is discrete, and hence, a normal distribution will never be quite right.  Better to use a poisson or a negative binomial.</p>

<p>But, &ldquo;Sheesh!&rdquo;, one might say, &ldquo;Come on!  How different can these models be?  I mean, I&rsquo;m going to get roughly the same answer, right?&rdquo;</p>

<p>O&rsquo;Hara and Kotze&rsquo;s paper takes this question and runs with it.  They simulate count data from negative binomial distributions and look at the results from generalized linear models with <a href="http://en.wikipedia.org/wiki/Negative_binomial">negative binomial</a> or <a href="http://en.wikipedia.org/wiki/Quasi-likelihood">quasi-poisson</a> error terms (see <a href="http://dx.doi.org/10.1890/07-0043.1">here</a> for the difference) versus a slew of transformations.</p>

<p>Intriguingly, they find that glms (with either distribution) always perform well, while each transformation performs poorly at some or all values.</p>

<p>[caption id=&ldquo;attachment_329&rdquo; align=&ldquo;aligncenter&rdquo; width=&ldquo;482&rdquo; caption=&ldquo;Estimated root mean-squared error from six different models.  Curves from the quasi-poisson model are the same as the negative binomial.  Note that the glm lines (black solid) all hang out around 0 as opposed to the transformed fits.&rdquo;]<img src="http://www.imachordata.com/wp-content/uploads/2010/06/nf3.gif" alt="" />[/caption]</p>

<p>More intriguingly to me are the results regarding bias.  Bias is the deviation between a fit parameter and its true value.  Bascially, it&rsquo;s a measure of how wrong your answer is.  Again, here they find almost no bias in the glms, but bias all over the charts for transformed fits.</p>

<p>[caption id=&ldquo;attachment_331&rdquo; align=&ldquo;aligncenter&rdquo; width=&ldquo;492&rdquo; caption=&ldquo;Estimated mean biases from six different models, applied to data simulated from a negative binomial distribution. A low bias means that the method will, on average, return the &lsquo;true&rsquo; value.  Note that the bias for transformed fits is all over the place.  But with a glm, bias is always minimal.&rdquo;]<img src="http://www.imachordata.com/wp-content/uploads/2010/06/nf2.gif" alt="" />[/caption]</p>

<p>They sum it up nicely</p>

<blockquote>For count data, our results suggest that transformations perform poorly. An additional problem with regression of transformed variables is that it can lead to impossible predictions, such as negative numbers of individuals. Instead statistical procedures designed to deal with counts should be used, i.e. methods for fitting Poisson or negative binomial models to data. The development of statistical and computational methods over the last 40 years has made it easier to fit these sorts of models, and the procedures for doing this are available in any serious statistics package.</blockquote>

<p>Or, more succinctly, &ldquo;Do not log-transform count data, bitches!&rdquo;</p>

<p>&ldquo;But how?!&rdquo; I&rsquo;m sure some of you are saying.  Well, after checking into <a href="http://dx.doi.org/10.1016/S0167-6296(01)00086-8">some</a> <a href="http://www.fs.fed.us/psw/publications/documents/psw_gtr191/psw_gtr191_0744-0753_seavy.pdf">of</a> the <a href="http://dx.doi.org/10.1890/07-0043.1">relevant</a> <a href="http://dx.doi.org/doi:10.1016/j.tree.2008.10.008">literature</a>, it&rsquo;s quite straightforward.</p>

<p>Given the ease of implementing glms in languages like R (one uses the glm function, checks diagnostics of residuals to ensure compliance with model assumptions, then can use Likliehood ratio testing akin to anova with, well, the Anova function) this is something easily within the grasp of the everyday ecologist.  Heck, you can even do posthocs with multcomp, although if you want to correct your p-values (and there are reasons to believe you shouldn&rsquo;t), you need to carefully consider the correction type.</p>

<p>For example, consider this data from survivorship on the Titanic (what, it&rsquo;s in the multcomp documentation!) - although, granted, it&rsquo;s looking at proportion survivorship, but, still, you&rsquo;ll see how the code works:</p>

<pre><code class="language-r">library(multcomp)
### set up all pair-wise comparisons for count data
data(Titanic)
mod &lt;- glm(Survived ~ Class, data = as.data.frame(Titanic), weights = Freq, family = binomial)

### specify all pair-wise comparisons among levels of variable &quot;Class&quot;
### Note, Tukey means the type of contrast matrix.  See ?contrMat
glht.mod &lt;- glht(mod, mcp(Class = &quot;Tukey&quot;))

###summaryize information
###applying the false discovery rate adjustment
###you know, if that's how you roll
summary(glht.mod, test=adjusted(&quot;fdr&quot;))
</code></pre>

<p>There are then a variety of ways to plot or otherwise view glht output.</p>

<p>So, that&rsquo;s the nerdy details.  In sum, though, the next time you see someone doing analyses with count data using simple linear regression or ANOVA with a log, sqrt, arcsine sqrt, or any other transformation, jump on them like a live grenade.  Then, once the confusion has worn off, give them a copy of this paper.  They&rsquo;ll thank you, once they&rsquo;re finished swearing.</p>

<p>O&rsquo;Hara, R., &amp; Kotze, D. (2010). Do not log-transform count data Methods in Ecology and Evolution, 1 (2), 118-122 DOI: <a href="http://dx.doi.org/10.1111/j.2041-210X.2010.00021.x">10.1111/j.2041-210X.2010.00021.x</a></p>


                
                
<div class="entry-shang text-center">
    
	    <p>「真诚赞赏，手留余香」</p>
	
	<button class="zs show-zs btn btn-bred">赞赏支持</button>
</div>
<div class="zs-modal-bg"></div>
<div class="zs-modal-box">
	<div class="zs-modal-head">
		<button type="button" class="close">×</button>
		<span class="author"><a href="/"><img src="/img/favicon.png" />Huabing Blog</a></span>
        
	        <p class="tip"><i></i><span>真诚赞赏，手留余香</span></p>
		
 
	</div>
	<div class="zs-modal-body">
		<div class="zs-modal-btns">
			<button class="btn btn-blink" data-num="2">2元</button>
			<button class="btn btn-blink" data-num="5">5元</button>
			<button class="btn btn-blink" data-num="10">10元</button>
			<button class="btn btn-blink" data-num="50">50元</button>
			<button class="btn btn-blink" data-num="100">100元</button>
			<button class="btn btn-blink" data-num="1">任意金额</button>
		</div>
		<div class="zs-modal-pay">
			<button class="btn btn-bred" id="pay-text">2元</button>
			<p>使用<span id="pay-type">微信</span>扫描二维码完成支付</p>
			<img src="/img/reward/wechat-2.png"  id="pay-image"/>
		</div>
	</div>
	<div class="zs-modal-footer">
		<label><input type="radio" name="zs-type" value="wechat" class="zs-type" checked="checked"><span ><span class="zs-wechat"><img src="/img/reward/wechat-btn.png"/></span></label>
		<label><input type="radio" name="zs-type" value="alipay" class="zs-type" class="zs-alipay"><img src="/img/reward/alipay-btn.png"/></span></label>
	</div>
</div>
<script type="text/javascript" src="/js/reward.js"></script>

                

                <hr>
                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/post/my-dissertation-in-under-7-minutes/" data-toggle="tooltip" data-placement="top" title="My Dissertation in Under 7 Minutes">&larr;
                            Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/post/tunicate-whiskey/" data-toggle="tooltip" data-placement="top" title="Tunicate Whiskey">Next
                            Post &rarr;</a>
                    </li>
                    
                </ul>

                
<div id="disqus-comment"></div>



            </div>
            
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                
                
                <section>
                    <hr class="hidden-sm hidden-xs">
                    <h5><a href="/tags/">FEATURED TAGS</a></h5>
                    <div class="tags">
                        
                        
                        
                        
                        
                        <a href="/tags/ascidian" title="ascidian">
                            ascidian
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/blog" title="blog">
                            blog
                        </a>
                        
                        
                        
                        
                        
                        <a href="/tags/climate-change" title="climate-change">
                            climate-change
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/experiment" title="experiment">
                            experiment
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/food-web" title="food-web">
                            food-web
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/ggplot2" title="ggplot2">
                            ggplot2
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/kelp-forest" title="kelp-forest">
                            kelp-forest
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/power-analysis" title="power-analysis">
                            power-analysis
                        </a>
                        
                        
                        
                        
                        
                        <a href="/tags/r" title="r">
                            r
                        </a>
                        
                        
                        
                        
                        
                        <a href="/tags/rb-editor-selection" title="rb-editor-selection">
                            rb-editor-selection
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/sea-squirt" title="sea-squirt">
                            sea-squirt
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/statistics" title="statistics">
                            statistics
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/tunicate" title="tunicate">
                            tunicate
                        </a>
                        
                        
                        
                        <a href="/tags/urchins" title="urchins">
                            urchins
                        </a>
                        
                        
                    </div>
                </section>
                

                
                
                <section>
                    <hr>
                    <h5>FRIENDS</h5>
                    <ul class="list-inline">
                        
                        <li><a target="_blank" href="https://zhaozhihan.com">Linda的博客</a></li>
                        
                    </ul>
                </section>
                
            </div>
        </div>
    </div>
</article>




<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                   
                   <li>
                       <a href="" rel="alternate" type="application/rss+xml" title="Huabing Blog" >
                           <span class="fa-stack fa-lg">
                               <i class="fa fa-circle fa-stack-2x"></i>
                               <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                           </span>
                       </a>
                   </li>
                   
                    
                    <li>
                        <a href="mailto:youremail@gmail.com">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
		    
                    
                    
                    
                    

                    

		    
                    
                    <li>
                        <a target="_blank" href="/your%20wechat%20qr%20code%20image">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-wechat fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
		    
                    
                    <li>
                        <a target="_blank" href="https://github.com/yourgithub">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
		    
                    
                    <li>
                        <a target="_blank" href="https://www.linkedin.com/in/yourlinkedinid">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
		    
                    
                </ul>
		<p class="copyright text-muted">
                    Copyright &copy; Huabing Blog 2019
                    <br>
                    <a href="https://themes.gohugo.io/hugo-theme-cleanwhite">CleanWhite Hugo Theme</a> by <a href="https://zhaohuabing.com">Huabing</a> |
                    <iframe
                        style="margin-left: 2px; margin-bottom:-5px;"
                        frameborder="0" scrolling="0" width="100px" height="20px"
                        src="https://ghbtns.com/github-btn.html?user=zhaohuabing&repo=hugo-theme-cleanwhite&type=star&count=true" >
                    </iframe>
                </p>
            </div>
        </div>
    </div>
</footer>




<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>






<script>
    
    if($('#tag_cloud').length !== 0){
        async("/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>


<script>
    async("https://cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>






</body>
</html>
